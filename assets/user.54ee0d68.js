import{G as st,A as ot,c as b,o as rt,b as p,d as t,e as A,g as r,t as l,j as at,f as m,P as y,F as k,q as C,y as g,C as R,af as nt}from"./index.be84e892.js";import{u as it}from"./useHandoutsData.3ee51d41.js";import{z as lt,v as dt}from"./vodVote.1d803d80.js";import{C as ct,a as ut,L as bt,T as pt,P as gt,b as mt,B as ht,A as xt,p as vt,c as ft,d as yt,i as wt,e as E,D as _t,S as kt}from"./index.55b785f6.js";import"./chartjs-adapter-date-fns.esm.7fb77aa4.js";const Ct={class:"user-stats-page min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900 p-4"},St={class:"max-w-7xl mx-auto"},Dt={class:"breadcrumb mt-8 mb-2 print:hidden"},At={key:0,class:"flex justify-center items-center h-64"},Rt={key:1,class:"bg-red-500/20 backdrop-blur-md rounded-xl p-6 ring-1 ring-red-500 text-white"},Et={key:2,class:"bg-white/10 backdrop-blur-md rounded-xl p-12 ring-1 ring-white/20 text-center text-white"},Lt={class:"mb-6"},Tt={key:3,class:"stats-content"},zt={class:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8"},$t={class:"flex items-center gap-3"},jt={class:"text-4xl font-bold text-white"},Ot={key:0,class:"flex items-center gap-2 px-3 py-1.5 bg-green-500/20 rounded-full ring-1 ring-green-500/50",title:"Connected to Twitch chat - realtime updates enabled"},Bt={class:"text-white/60 mt-1"},Mt={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"},Vt={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},Wt={class:"text-3xl font-bold text-yellow-400"},Ht={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},Ft={class:"text-3xl font-bold text-blue-400"},Ut={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},Nt={class:"text-3xl font-bold text-green-400"},Pt={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},qt={class:"text-3xl font-bold text-purple-400"},Gt={class:"mb-8"},It={class:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4"},Zt={class:"flex items-center justify-center gap-2 mb-2"},Jt=["src","alt"],Kt={key:1,class:"text-xl"},Qt={class:"text-sm text-white/60"},Xt={class:"text-xs text-white/40 mt-1"},Yt={class:"mb-8"},te={class:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4"},ee={class:"text-2xl mb-2"},se={class:"text-sm font-semibold text-white"},oe={class:"text-xs text-white/60 mt-1"},re={class:"grid md:grid-cols-2 gap-6 mb-8"},ae={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},ne={class:"h-64"},ie={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},le={class:"h-64"},de={class:"mb-8"},ce={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},ue={class:"h-64"},be={class:"mb-8"},pe={class:"bg-white/10 backdrop-blur-md rounded-xl p-6 ring-1 ring-white/20"},ge={class:"h-48"},me={class:"mb-8"},he={class:"bg-white/10 backdrop-blur-md rounded-xl overflow-hidden ring-1 ring-white/20"},xe={class:"overflow-x-auto max-h-96"},ve={class:"w-full"},fe={class:"divide-y divide-white/10"},ye={class:"px-4 py-3 text-sm text-white/70"},we={class:"px-4 py-3"},_e={class:"px-4 py-3 text-sm text-white/80 max-w-xs truncate"},ke={class:"px-4 py-3 text-right font-bold text-yellow-400"},Le={__name:"user",setup(Ce){ct.register(ut,bt,pt,gt,mt,ht,xt,vt,ft,yt,wt);const L=st();ot();const x=b(()=>L.query.username||""),{isLoading:T,error:S,loadedMonths:z,loadData:$,getUserHandouts:j,getUserRank:O,connectRealtime:B,isTwitchConnected:M}=it();rt(async()=>{await $();try{await B()}catch(s){console.warn("Failed to connect to Twitch chat:",s)}});const h={zoskyZappers:"rgb(59, 130, 246)",squadRush:"rgb(239, 68, 68)",vodVote:"rgb(34, 197, 94)",art:"rgb(168, 85, 247)",chevos:"rgb(234, 179, 8)",voucher:"rgb(236, 72, 153)",manual:"rgb(156, 163, 175)",referral:"rgb(20, 184, 166)",sub:"rgb(168, 85, 247)",discoReact:"rgb(88, 101, 242)",vodFeedback:"rgb(251, 146, 60)",redeem:"rgb(239, 68, 68)"},D={zoskyZappers:lt,vodVote:dt,art:nt},V={voucher:"\u{1F4B0}",referral:"\u{1F465}",sub:"\u2B50",discoReact:"\u{1F4AC}",vodFeedback:"\u{1F4DD}",redeem:"\u{1F3AE}",chevos:"\u{1F3C6}",squadRush:"\u{1F44A}",manual:"\u2699\uFE0F"},c=b(()=>j(x.value)),W=b(()=>O(x.value)),f=b(()=>c.value.filter(s=>s.source!=="redeem").reduce((s,e)=>s+e.amount,0)),w=b(()=>c.value.filter(s=>s.source!=="redeem").length),H=b(()=>w.value>0?Math.round(f.value/w.value):0),F=b(()=>new Set(c.value.map(s=>s.date)).size),v=b(()=>{const s={};return c.value.forEach(e=>{s[e.source]||(s[e.source]={count:0,total:0}),s[e.source].count++,s[e.source].total+=e.amount}),Object.entries(s).map(([e,o])=>({source:e,count:o.count,total:o.total,avg:Math.round(o.total/o.count),percentage:f.value>0?Math.round(o.total/f.value*100):0})).sort((e,o)=>o.total-e.total)}),U=b(()=>{const s=[],e={};c.value.forEach(u=>{e[u.hour]=(e[u.hour]||0)+u.amount});const o=Object.entries(e).sort((u,_)=>_[1]-u[1])[0];o&&s.push({type:"peak-hour",title:"Peak Hour",description:`${String(o[0]).padStart(2,"0")}:00 (${o[1].toLocaleString()} zC)`,icon:"\u23F0"});const i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a={};c.value.forEach(u=>{a[u.dayOfWeek]=(a[u.dayOfWeek]||0)+1});const n=Object.entries(a).sort((u,_)=>_[1]-u[1])[0];n&&s.push({type:"favorite-day",title:"Best Day",description:`${i[n[0]]} (${n[1]} wins)`,icon:"\u{1F4C5}"});const d=v.value[0];d&&s.push({type:"top-source",title:"Top Game",description:`${d.source} (${d.total.toLocaleString()} zC)`,icon:"\u{1F3AE}"});const tt=c.value.filter(u=>u.amount>=100).length;s.push({type:"big-wins",title:"Big Wins",description:`${tt} wins of 100+ zC`,icon:"\u{1F48E}"});const et=new Set(c.value.map(u=>u.source)).size;return s.push({type:"diversity",title:"Sources",description:`${et} different games`,icon:"\u{1F3AF}"}),s}),N=b(()=>[...c.value].sort((s,e)=>e.timestamp-s.timestamp).slice(0,50)),P=b(()=>{const s={},e=new Set;c.value.forEach(a=>{s[a.date]||(s[a.date]={}),s[a.date][a.source]||(s[a.date][a.source]=0),s[a.date][a.source]+=a.amount,e.add(a.source)});const o=Object.keys(s).sort().slice(-14),i=Array.from(e).map(a=>({label:a,data:o.map(n=>{var d;return((d=s[n])==null?void 0:d[a])||0}),backgroundColor:h[a]||"rgb(100, 116, 139)",borderColor:"rgba(0, 0, 0, 0.3)",borderWidth:1}));return{labels:o,datasets:i}}),q=b(()=>{const s=v.value.map(i=>i.source),e=v.value.map(i=>i.total),o=v.value.map(i=>h[i.source]||"rgb(100, 116, 139)");return{labels:s,datasets:[{data:e,backgroundColor:o,borderWidth:2,borderColor:"rgba(0,0,0,0.8)"}]}}),G=b(()=>{const s=Array(24).fill(0);return c.value.forEach(e=>{s[e.hour]+=e.amount}),{labels:Array.from({length:24},(e,o)=>`${o}:00`),datasets:[{label:"Earnings",data:s,backgroundColor:"rgba(59, 130, 246, 0.6)",borderColor:"rgb(59, 130, 246)",borderWidth:1}]}}),I=b(()=>{const s=new Date,e=new Date(s);e.setDate(e.getDate()-6),e.setHours(0,0,0,0);const o=e.getTime(),i={};return c.value.forEach(n=>{n.timestamp<o||(i[n.source]||(i[n.source]=[]),i[n.source].push({x:n.timestamp,y:n.amount,reason:n.reason}))}),{datasets:Object.entries(i).map(([n,d])=>({label:n,data:d,backgroundColor:h[n]||"rgb(100, 116, 139)",borderColor:h[n]||"rgb(100, 116, 139)",pointRadius:6,pointHoverRadius:10}))}}),Z={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"rgba(255,255,255,0.8)",font:{size:10}}},tooltip:{backgroundColor:"rgba(0,0,0,0.8)"}},scales:{x:{stacked:!0,ticks:{color:"rgba(255,255,255,0.6)"},grid:{color:"rgba(255,255,255,0.1)"}},y:{stacked:!0,ticks:{color:"rgba(255,255,255,0.6)"},grid:{color:"rgba(255,255,255,0.1)"}}}},J={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{color:"rgba(255,255,255,0.8)"}},tooltip:{backgroundColor:"rgba(0,0,0,0.8)"}}},K={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0,0,0,0.8)"}},scales:{x:{ticks:{color:"rgba(255,255,255,0.6)"},grid:{color:"rgba(255,255,255,0.1)"}},y:{ticks:{color:"rgba(255,255,255,0.6)"},grid:{color:"rgba(255,255,255,0.1)"}}}},Q={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{color:"rgba(255,255,255,0.8)",font:{size:10}}},tooltip:{backgroundColor:"rgba(0,0,0,0.9)",callbacks:{title:s=>new Date(s[0].parsed.x).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),label:s=>[`${s.dataset.label}: ${s.raw.y} zC`,s.raw.reason||""].filter(Boolean)}}},scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"EEE MMM d"}},ticks:{color:"rgba(255,255,255,0.6)"},grid:{color:"rgba(255,255,255,0.1)"}},y:{beginAtZero:!0,title:{display:!0,text:"zC Amount",color:"rgba(255,255,255,0.6)"},ticks:{color:"rgba(255,255,255,0.6)"},grid:{color:"rgba(255,255,255,0.1)"}}}};function X(s){return new Date(s).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}function Y(){const s=["Date","Source","Reason","Amount"],e=c.value.map(d=>[new Date(d.timestamp).toISOString(),d.source,`"${d.reason.replace(/"/g,'""')}"`,d.amount]),o=[s.join(","),...e.map(d=>d.join(","))].join(`
`),i=new Blob([o],{type:"text/csv"}),a=URL.createObjectURL(i),n=document.createElement("a");n.href=a,n.download=`${x.value}-stats.csv`,n.click(),URL.revokeObjectURL(a)}return(s,e)=>(g(),p("div",Ct,[t("div",St,[t("div",Dt,[t("button",{onClick:e[0]||(e[0]=o=>s.$router.push("/stats")),class:"text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-2"},[...e[2]||(e[2]=[t("span",null,"\u2190",-1),A(" Back to Leaderboard ",-1)])])]),r(T)?(g(),p("div",At,[...e[3]||(e[3]=[t("div",{class:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-blue-400"},null,-1)])])):r(S)?(g(),p("div",Rt,[e[4]||(e[4]=t("h2",{class:"text-xl font-bold mb-2"},"\u26A0\uFE0F Error",-1)),t("p",null,l(r(S)),1)])):r(c).length===0?(g(),p("div",Et,[e[5]||(e[5]=t("h2",{class:"text-2xl font-bold mb-4"},"No Data Found",-1)),t("p",Lt,"No handout history found for "+l(r(x)),1),t("button",{onClick:e[1]||(e[1]=o=>s.$router.push("/stats")),class:"px-6 py-3 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors"}," \u2190 Back to Leaderboard ")])):(g(),p("div",Tt,[t("div",zt,[t("div",null,[t("div",$t,[t("h1",jt," \u{1F4CA} "+l(r(x))+"'s Stats ",1),r(M)?(g(),p("div",Ot,[...e[6]||(e[6]=[t("span",{class:"relative flex h-2.5 w-2.5"},[t("span",{class:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),t("span",{class:"relative inline-flex rounded-full h-2.5 w-2.5 bg-green-500"})],-1),t("span",{class:"text-green-400 text-sm font-medium"},"LIVE",-1)])])):at("",!0)]),t("p",Bt," Rank #"+l(r(W))+" \u2022 Data from "+l(r(z).join(" & ")),1)]),t("div",{class:"export-toolbar flex gap-2 print:hidden"},[t("button",{onClick:Y,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm"}," \u{1F4E5} Export CSV ")])]),t("div",Mt,[t("div",Vt,[e[7]||(e[7]=t("div",{class:"text-sm text-white/70 mb-1"},"Total Earned",-1)),t("div",Wt,[m(y,{currency:"zC",n:r(f)},null,8,["n"])])]),t("div",Ht,[e[8]||(e[8]=t("div",{class:"text-sm text-white/70 mb-1"},"Avg Per Win",-1)),t("div",Ft,[m(y,{currency:"zC",n:r(H)},null,8,["n"])])]),t("div",Ut,[e[9]||(e[9]=t("div",{class:"text-sm text-white/70 mb-1"},"Total Wins",-1)),t("div",Nt,l(r(w)),1)]),t("div",Pt,[e[10]||(e[10]=t("div",{class:"text-sm text-white/70 mb-1"},"Active Days",-1)),t("div",qt,l(r(F)),1)])]),t("section",Gt,[e[11]||(e[11]=t("h2",{class:"text-2xl font-bold text-white mb-4"},"\u{1F3AE} Earnings by Game",-1)),t("div",It,[(g(!0),p(k,null,C(r(v),o=>(g(),p("div",{key:o.source,class:"bg-white/10 backdrop-blur-md rounded-xl p-4 ring-1 ring-white/20 text-center"},[t("div",Zt,[D[o.source]?(g(),p("img",{key:0,src:D[o.source],alt:o.source,class:"w-6 h-6"},null,8,Jt)):(g(),p("span",Kt,l(V[o.source]||"\u{1F3AE}"),1)),t("span",Qt,l(o.source),1)]),t("div",{class:"text-2xl font-bold",style:R({color:h[o.source]||"#94a3b8"})},[m(y,{currency:"zC",n:o.source==="redeem"?Math.abs(o.total):o.total},null,8,["n"])],4),t("div",Xt,l(o.count)+" wins ("+l(o.percentage)+"%)",1)]))),128))])]),t("section",Yt,[e[12]||(e[12]=t("h2",{class:"text-2xl font-bold text-white mb-4"},"\u{1F50D} Insights",-1)),t("div",te,[(g(!0),p(k,null,C(r(U),o=>(g(),p("div",{key:o.type,class:"bg-white/10 backdrop-blur-md rounded-xl p-4 ring-1 ring-white/20"},[t("div",ee,l(o.icon),1),t("div",se,l(o.title),1),t("div",oe,l(o.description),1)]))),128))])]),t("div",re,[t("div",ae,[e[13]||(e[13]=t("h2",{class:"text-xl font-bold text-white mb-4"},"\u{1F4C5} Daily Earnings",-1)),t("div",ne,[m(r(E),{data:r(P),options:Z},null,8,["data"])])]),t("div",ie,[e[14]||(e[14]=t("h2",{class:"text-xl font-bold text-white mb-4"},"\u{1F4CA} Source Distribution",-1)),t("div",le,[m(r(_t),{data:r(q),options:J},null,8,["data"])])])]),t("section",de,[e[15]||(e[15]=t("h2",{class:"text-2xl font-bold text-white mb-4"},"\u23F1\uFE0F Activity Timeline (Last 7 Days)",-1)),t("div",ce,[t("div",ue,[m(r(kt),{data:r(I),options:Q},null,8,["data"])])])]),t("section",be,[e[16]||(e[16]=t("h2",{class:"text-2xl font-bold text-white mb-4"},"\u{1F550} Activity by Hour",-1)),t("div",pe,[t("div",ge,[m(r(E),{data:r(G),options:K},null,8,["data"])])])]),t("section",me,[e[19]||(e[19]=t("h2",{class:"text-2xl font-bold text-white mb-4"},"\u{1F4DC} Recent Activity",-1)),t("div",he,[t("div",xe,[t("table",ve,[e[18]||(e[18]=t("thead",{class:"bg-white/5 sticky top-0"},[t("tr",{class:"text-white/90 text-left"},[t("th",{class:"px-4 py-3 font-semibold"},"Date"),t("th",{class:"px-4 py-3 font-semibold"},"Source"),t("th",{class:"px-4 py-3 font-semibold"},"Reason"),t("th",{class:"px-4 py-3 font-semibold text-right"},"Amount")])],-1)),t("tbody",fe,[(g(!0),p(k,null,C(r(N),(o,i)=>(g(),p("tr",{key:i,class:"text-white hover:bg-white/5"},[t("td",ye,l(X(o.timestamp)),1),t("td",we,[t("span",{class:"px-2 py-1 rounded text-xs font-medium",style:R({backgroundColor:h[o.source]+"33",color:h[o.source]})},l(o.source),5)]),t("td",_e,l(o.reason),1),t("td",ke,[e[17]||(e[17]=A("+",-1)),m(y,{currency:"zC",n:o.amount},null,8,["n"])])]))),128))])])])])])]))])]))}};export{Le as default};
